import{Y as ee,a as y,j as e,a9 as re}from"./index-BmTDuvZb.js";import{T as Y}from"./index-BADhTaSU.js";import{i as oe,j as E,k as te,l as ae}from"./Drawer-DzqlIjEr.js";import{u as se}from"./useData-BOaL--7C.js";import{A as ie}from"./AdaptiveCard-CrXiXQ44.js";import{N as x}from"./Notification-tU2EwgzP.js";import{t as g}from"./toast-GyZEIVmG.js";import{h as ne}from"./moment-BLMuvzoS.js";import{I as f}from"./FormContainer-DAIJ54eo.js";import"./index-DiLTFOK_.js";import{C as le}from"./ConfirmDialog-teBenfrx.js";import"./FileItem-DzXY3F8e.js";import{B as b}from"./Button-DurQkwM5.js";import{D as ce}from"./DebouceInput-CO8iQz0e.js";import"./debounce-BDIv-DRu.js";import"./Badge-CndVQ9ZH.js";import{D as de}from"./Dialog-DLr3sM2V.js";import{o as me,s as j,u as pe,t as he,F as ue,a as C,C as S}from"./types-CS3IvESl.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import"./index-Dp3eu27c.js";import{c as M}from"./criteriaService-BmWfB9h2.js";import{R as N,C as w}from"./row-BhmCD8Yc.js";import{F as xe,P as ge}from"./Table-D5q3gGnO.js";import"./isNil-pXqcj5Hj.js";import"./CloseButton-DJjxVEoc.js";import"./classNames-1IIsPMBF.js";import"./index-D_KHXJS9.js";import"./Card-BgjqMMuG.js";import"./StatusIcon-DsewrCSG.js";import"./apiService-CUP-TZv2.js";import"./context-Du5Tb9SW.js";import"./toConsumableArray-BwQuJZQe.js";import"./useBreakpoint-B4e-Cr1A.js";import"./extendsObject-BwUYxLSG.js";import"./index-D8WFQQX-.js";import"./Compact-BRfsaHnR.js";import"./AntdIcon-Bbd_N7Ky.js";import"./omit-B089rQxj.js";import"./EllipsisOutlined-BvS74-YI.js";import"./getAllowClear-TCr_opQ2.js";import"./useVariants-D5R8gtcG.js";const fe=()=>se("/criterias"),je=me({name:j().trim().min(1,"Name of criteria is required"),minScore:j().trim().min(1,"Minimum score of the criteria is required"),maxScore:j().trim().min(1,"Maximum score of the criteria is required"),description:j().optional()}),nr=()=>{var P,T,F,I,R;const{signOut:q}=ee(),{data:z,total:p,isLoading:O,pagination:t,setPagination:c,authenticated:K}=fe(),[L,U]=y.useState(""),[o,s]=y.useState({record:null,isCreate:!0,loading:!1,showModal:!1}),[i,d]=y.useState({record:null,loading:!1,showModal:!1}),{control:h,reset:u,handleSubmit:_,formState:{errors:n}}=pe({resolver:he(je)}),D=()=>{u({name:"",minScore:"",maxScore:"",description:""})},H=()=>{D(),s({...o,record:null,isCreate:!0,showModal:!0})},V=()=>{D(),s({...o,record:null,isCreate:!0,showModal:!1})},W=r=>{u({name:r.name,minScore:r.minScore.toString(),maxScore:r.maxScore.toString(),description:r.description??""}),s({...o,record:r,isCreate:!1,showModal:!0})},G=r=>{if(s({...o,loading:!0}),o.isCreate)M.create(r).then(a=>{u(),s({record:null,loading:!1,isCreate:!0,showModal:!1}),c({...t,page:1}),g.push(e.jsx(x,{title:"Success",type:"success",children:"Record has been created successfully"}))}).catch(a=>{var l,m;g.push(e.jsx(x,{title:"Failed",type:"danger",children:((m=(l=a.response)==null?void 0:l.data)==null?void 0:m.message)||"Something went wrong, try again"})),s({...o,loading:!1})});else{const a={...r,uuid:o.record!=null?o.record.uuid:""};M.update(a).then(l=>{u(),s({record:null,loading:!1,isCreate:!0,showModal:!1}),c({...t,page:1}),g.push(e.jsx(x,{title:"Success",type:"success",children:"Record has been updated successfully"}))}).catch(l=>{var m,A;g.push(e.jsx(x,{title:"Failed",type:"danger",children:((A=(m=l.response)==null?void 0:m.data)==null?void 0:A.message)||"Something went wrong, try again"})),s({...o,loading:!1})})}},J=()=>{var r;d({...i,loading:!0}),M.delete(((r=i.record)==null?void 0:r.uuid)??"").then(a=>{d({record:null,loading:!1,showModal:!1}),c({...t,page:1})}).catch(a=>{d({...i,loading:!1})})};K||q();const v=()=>{d({...i,record:null,showModal:!1})},Q=r=>{d({...i,record:r,showModal:!0})},k=()=>t.perPage*(t.page-1),X=()=>{let r=k()+t.perPage;return p<r&&(r=p),r},Z=r=>{c({...t,page:r})},B=()=>{c({...t,page:1,search:L})},$=[{title:"S/n",dataIndex:"s_no",key:"s_no",render:(r,a,l)=>(t.page-1)*t.perPage+l+1},{title:"Name",dataIndex:"name",key:"name"},{title:"Maximum Score",dataIndex:"maxScore",key:"maxScore"},{title:"Min Score",dataIndex:"minScore",key:"minScore"},{title:"Description",dataIndex:"description",key:"description"},{title:"Created At",dataIndex:"createdAt",key:"createdAt",render:r=>ne(r).format("DD MMM YYYY")},{title:"Action",dataIndex:"action",key:"action",render:(r,a)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Y,{wrapperClass:"flex",title:"View",children:e.jsx("span",{className:"cursor-pointer p-2 text-warning",onClick:()=>W(a),children:e.jsx(te,{size:20})})}),e.jsx(Y,{wrapperClass:"flex",title:"Delete",children:e.jsx("span",{className:"cursor-pointer p-2 text-red-500 hover:text-red-500",onClick:()=>Q(a),children:e.jsx(ae,{size:20})})})]})}];return e.jsx(re,{children:e.jsx(ie,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Criterias"}),e.jsx(b,{variant:"solid",icon:e.jsx(oe,{className:"text-xl"}),onClick:H,children:"Add new"})]}),e.jsx(N,{className:"mt-5",children:e.jsx(w,{span:24,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsx(ce,{placeholder:"Search",suffix:e.jsx(E,{className:"text-lg"}),onChange:r=>U(r.target.value),onKeyDown:r=>r.key==="Enter"&&B()}),e.jsx(b,{icon:e.jsx(E,{}),onClick:()=>B(),children:"Search"})]})})}),e.jsx(N,{className:"mt-5",children:e.jsx(w,{span:24,children:e.jsx(xe,{dataSource:z,columns:$,rowKey:"uuid",loading:O,pagination:!1})})}),e.jsxs(N,{className:"mt-4",children:[e.jsx(w,{sm:24,md:12,children:e.jsxs("p",{className:"Criteria",children:["Showing ",k()+1," to ",X()," of ",p," ","entries"]})}),e.jsx(w,{sm:24,md:12,children:e.jsx(ge,{align:"end",current:t.page,total:p,pageSize:t.perPage,onChange:Z})})]}),e.jsxs(de,{isOpen:o.showModal,onClose:V,children:[e.jsx("h4",{className:"mb-4 text-center",children:o.isCreate?"Create Criterias":"Update Criterias"}),e.jsxs(ue,{onSubmit:_(G),children:[e.jsx(C,{label:"Name",invalid:!!n.name,errorMessage:(P=n.name)==null?void 0:P.message,children:e.jsx(S,{name:"name",control:h,render:({field:r})=>e.jsx(f,{type:"text",placeholder:"Name",autoComplete:"off",...r})})}),e.jsx(C,{label:"Maximum Score",invalid:!!n.maxScore,errorMessage:(T=n.maxScore)==null?void 0:T.message,children:e.jsx(S,{name:"maxScore",control:h,render:({field:r})=>e.jsx(f,{type:"number",placeholder:"Maximum Score in this criteria",autoComplete:"off",...r})})}),e.jsx(C,{label:"Minimum Score",invalid:!!n.minScore,errorMessage:(F=n.minScore)==null?void 0:F.message,children:e.jsx(S,{name:"minScore",control:h,render:({field:r})=>e.jsx(f,{type:"number",placeholder:"Minimum Score in this criteria",autoComplete:"off",...r})})}),e.jsx(C,{label:"Description",invalid:!!n.description,errorMessage:(I=n.description)==null?void 0:I.message,children:e.jsx(S,{name:"description",control:h,render:({field:r})=>e.jsx(f,{type:"text",placeholder:"Description",autoComplete:"off",textArea:!0,...r})})}),e.jsx(b,{loading:o.loading,variant:"solid",type:"submit",children:o.isCreate?"Create":"Update"})]})]}),e.jsx(le,{isOpen:i.showModal,type:"danger",title:"Warning",confirmText:"Delete",cancelButtonProps:{variant:"solid",color:"default",customColorClass:()=>"text-dark bg-gray-200 hover:bg-default mr-3"},confirmButtonProps:{variant:"solid",color:"danger",customColorClass:()=>"text-white bg-error hover:bg-error",loading:i.loading},onClose:v,onCancel:v,onConfirm:J,children:e.jsxs("p",{children:[" ","This action is irreversible! Deleting"," ",e.jsxs("span",{className:"font-semibold",children:[(R=i.record)==null?void 0:R.name," "]}),"will permanently remove it from the system. Are you sure you want to proceed?"]})})]})})})};export{nr as default};
