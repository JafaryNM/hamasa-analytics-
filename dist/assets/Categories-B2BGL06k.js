import{Y as Z,a as f,j as e,a9 as $}from"./index-BmTDuvZb.js";import{T}from"./index-BADhTaSU.js";import{i as ee,j as B,k as re,l as te}from"./Drawer-DzqlIjEr.js";import{u as oe}from"./useData-BOaL--7C.js";import{A as se}from"./AdaptiveCard-CrXiXQ44.js";import{N as u}from"./Notification-tU2EwgzP.js";import{t as g}from"./toast-GyZEIVmG.js";import{h as ae}from"./moment-BLMuvzoS.js";import{I as F}from"./FormContainer-DAIJ54eo.js";import"./index-DiLTFOK_.js";import{C as ne}from"./ConfirmDialog-teBenfrx.js";import"./FileItem-DzXY3F8e.js";import{B as j}from"./Button-DurQkwM5.js";import{D as ie}from"./DebouceInput-CO8iQz0e.js";import"./debounce-BDIv-DRu.js";import"./Badge-CndVQ9ZH.js";import{D as le}from"./Dialog-DLr3sM2V.js";import{o as de,s as R,u as ce,t as me,F as pe,a as A,C as I}from"./types-CS3IvESl.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import"./index-Dp3eu27c.js";import{c as C}from"./categoryService-CTpkvy7r.js";import{R as w,C as x}from"./row-BhmCD8Yc.js";import{F as he,P as ue}from"./Table-D5q3gGnO.js";import"./isNil-pXqcj5Hj.js";import"./CloseButton-DJjxVEoc.js";import"./classNames-1IIsPMBF.js";import"./index-D_KHXJS9.js";import"./Card-BgjqMMuG.js";import"./StatusIcon-DsewrCSG.js";import"./apiService-CUP-TZv2.js";import"./context-Du5Tb9SW.js";import"./toConsumableArray-BwQuJZQe.js";import"./useBreakpoint-B4e-Cr1A.js";import"./extendsObject-BwUYxLSG.js";import"./index-D8WFQQX-.js";import"./Compact-BRfsaHnR.js";import"./AntdIcon-Bbd_N7Ky.js";import"./omit-B089rQxj.js";import"./EllipsisOutlined-BvS74-YI.js";import"./getAllowClear-TCr_opQ2.js";import"./useVariants-D5R8gtcG.js";const ge=()=>oe("/categories"),xe=de({name:R().trim().min(1,"Name of category is required"),description:R().optional()}),ar=()=>{var v,M,k;const{signOut:Y}=Z(),{data:E,total:m,isLoading:z,pagination:o,setPagination:l,authenticated:O}=ge(),[K,L]=f.useState(""),[t,a]=f.useState({record:null,isCreate:!0,loading:!1,showModal:!1}),[n,d]=f.useState({record:null,loading:!1,showModal:!1}),{control:y,reset:p,handleSubmit:U,formState:{errors:h}}=ce({resolver:me(xe)}),b=()=>{p({name:"",description:""})},_=()=>{b(),a({...t,record:null,isCreate:!0,showModal:!0})},q=()=>{b(),a({...t,record:null,isCreate:!0,showModal:!1})},H=r=>{p({name:r.name,description:r.description??""}),a({...t,record:r,isCreate:!1,showModal:!0})},V=r=>{if(a({...t,loading:!0}),t.isCreate)C.create(r).then(s=>{p(),a({record:null,loading:!1,isCreate:!0,showModal:!1}),l({...o,page:1}),g.push(e.jsx(u,{title:"Success",type:"success",children:"Record has been created successfully"}))}).catch(s=>{var i,c;g.push(e.jsx(u,{title:"Failed",type:"danger",children:((c=(i=s.response)==null?void 0:i.data)==null?void 0:c.message)||"Something went wrong, try again"})),a({...t,loading:!1})});else{const s={...r,uuid:t.record!=null?t.record.uuid:""};C.update(s).then(i=>{p(),a({record:null,loading:!1,isCreate:!0,showModal:!1}),l({...o,page:1}),g.push(e.jsx(u,{title:"Success",type:"success",children:"Record has been updated successfully"}))}).catch(i=>{var c,P;g.push(e.jsx(u,{title:"Failed",type:"danger",children:((P=(c=i.response)==null?void 0:c.data)==null?void 0:P.message)||"Something went wrong, try again"})),a({...t,loading:!1})})}},W=()=>{var r;d({...n,loading:!0}),C.delete(((r=n.record)==null?void 0:r.uuid)??"").then(s=>{d({record:null,loading:!1,showModal:!1}),l({...o,page:1})}).catch(s=>{d({...n,loading:!1})})};O||Y();const S=()=>{d({...n,record:null,showModal:!1})},G=r=>{d({...n,record:r,showModal:!0})},N=()=>o.perPage*(o.page-1),J=()=>{let r=N()+o.perPage;return m<r&&(r=m),r},Q=r=>{l({...o,page:r})},D=()=>{l({...o,page:1,search:K})},X=[{title:"S/n",dataIndex:"s_no",key:"s_no",render:(r,s,i)=>(o.page-1)*o.perPage+i+1},{title:"Name",dataIndex:"name",key:"name"},{title:"Description",dataIndex:"description",key:"description"},{title:"Created At",dataIndex:"createdAt",key:"createdAt",render:r=>ae(r).format("DD MMM YYYY")},{title:"Action",dataIndex:"action",key:"action",render:(r,s)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx(T,{wrapperClass:"flex",title:"View",children:e.jsx("span",{className:"cursor-pointer p-2 text-warning",onClick:()=>H(s),children:e.jsx(re,{size:20})})}),e.jsx(T,{wrapperClass:"flex",title:"Delete",children:e.jsx("span",{className:"cursor-pointer p-2 text-red-500 hover:text-red-500",onClick:()=>G(s),children:e.jsx(te,{size:20})})})]})}];return e.jsx($,{children:e.jsx(se,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Categories"}),e.jsx(j,{variant:"solid",icon:e.jsx(ee,{className:"text-xl"}),onClick:_,children:"Add new"})]}),e.jsx(w,{className:"mt-5",children:e.jsx(x,{span:24,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsx(ie,{placeholder:"Search",suffix:e.jsx(B,{className:"text-lg"}),onChange:r=>L(r.target.value),onKeyDown:r=>r.key==="Enter"&&D()}),e.jsx(j,{icon:e.jsx(B,{}),onClick:()=>D(),children:"Search"})]})})}),e.jsx(w,{className:"mt-5",children:e.jsx(x,{span:24,children:e.jsx(he,{dataSource:E,columns:X,rowKey:"uuid",loading:z,pagination:!1})})}),e.jsxs(w,{className:"mt-4",children:[e.jsx(x,{sm:24,md:12,children:e.jsxs("p",{className:"category",children:["Showing ",N()+1," to ",J()," of ",m," ","entries"]})}),e.jsx(x,{sm:24,md:12,children:e.jsx(ue,{align:"end",current:o.page,total:m,pageSize:o.perPage,onChange:Q})})]}),e.jsxs(le,{isOpen:t.showModal,onClose:q,children:[e.jsx("h4",{className:"mb-4 text-center",children:t.isCreate?"Create Categories":"Update Categories"}),e.jsxs(pe,{onSubmit:U(V),children:[e.jsx(A,{label:"Name",invalid:!!h.name,errorMessage:(v=h.name)==null?void 0:v.message,children:e.jsx(I,{name:"name",control:y,render:({field:r})=>e.jsx(F,{type:"text",placeholder:"Name",autoComplete:"off",...r})})}),e.jsx(A,{label:"Description",invalid:!!h.description,errorMessage:(M=h.description)==null?void 0:M.message,children:e.jsx(I,{name:"description",control:y,render:({field:r})=>e.jsx(F,{type:"text",placeholder:"Description",autoComplete:"off",textArea:!0,...r})})}),e.jsx(j,{loading:t.loading,variant:"solid",type:"submit",children:t.isCreate?"Create":"Update"})]})]}),e.jsx(ne,{isOpen:n.showModal,type:"danger",title:"Warning",confirmText:"Delete",cancelButtonProps:{variant:"solid",color:"default",customColorClass:()=>"text-dark bg-gray-200 hover:bg-default mr-3"},confirmButtonProps:{variant:"solid",color:"danger",customColorClass:()=>"text-white bg-error hover:bg-error",loading:n.loading},onClose:S,onCancel:S,onConfirm:W,children:e.jsxs("p",{children:[" ","This action is irreversible! Deleting"," ",e.jsxs("span",{className:"font-semibold",children:[(k=n.record)==null?void 0:k.name," "]}),"will permanently remove it from the system. Are you sure you want to proceed?"]})})]})})})};export{ar as default};
