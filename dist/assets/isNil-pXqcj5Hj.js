import{a as n,j as x,g as L}from"./index-BmTDuvZb.js";import{M as $,u as z,P as D,o as S,L as b}from"./CloseButton-DJjxVEoc.js";class q extends n.Component{getSnapshotBeforeUpdate(i){const t=this.props.childRef.current;if(t&&i.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function A({children:r,isPresent:i}){const t=n.useId(),s=n.useRef(null),d=n.useRef({width:0,height:0,top:0,left:0}),{nonce:C}=n.useContext($);return n.useInsertionEffect(()=>{const{width:p,height:e,top:f,left:a}=d.current;if(i||!s.current||!p||!e)return;s.current.dataset.motionPopId=t;const l=document.createElement("style");return C&&(l.nonce=C),document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${e}px !important;
            top: ${f}px !important;
            left: ${a}px !important;
          }
        `),()=>{document.head.removeChild(l)}},[i]),x.jsx(q,{isPresent:i,childRef:s,sizeRef:d,children:n.cloneElement(r,{ref:s})})}const B=({children:r,initial:i,isPresent:t,onExitComplete:s,custom:d,presenceAffectsLayout:C,mode:p})=>{const e=z(F),f=n.useId(),a=n.useCallback(u=>{e.set(u,!0);for(const g of e.values())if(!g)return;s&&s()},[e,s]),l=n.useMemo(()=>({id:f,initial:i,isPresent:t,custom:d,onExitComplete:a,register:u=>(e.set(u,!1),()=>e.delete(u))}),C?[Math.random(),a]:[t,a]);return n.useMemo(()=>{e.forEach((u,g)=>e.set(g,!1))},[t]),n.useEffect(()=>{!t&&!e.size&&s&&s()},[t]),p==="popLayout"&&(r=x.jsx(A,{isPresent:t,children:r})),x.jsx(D.Provider,{value:l,children:r})};function F(){return new Map}const E=r=>r.key||"";function I(r){const i=[];return n.Children.forEach(r,t=>{n.isValidElement(t)&&i.push(t)}),i}const H=({children:r,exitBeforeEnter:i,custom:t,initial:s=!0,onExitComplete:d,presenceAffectsLayout:C=!0,mode:p="sync"})=>{const e=n.useMemo(()=>I(r),[r]),f=e.map(E),a=n.useRef(!0),l=n.useRef(e),u=z(()=>new Map),[g,N]=n.useState(e),[h,j]=n.useState(e);S(()=>{a.current=!1,l.current=e;for(let c=0;c<h.length;c++){const o=E(h[c]);f.includes(o)?u.delete(o):u.get(o)!==!0&&u.set(o,!1)}},[h,f.length,f.join("-")]);const y=[];if(e!==g){let c=[...e];for(let o=0;o<h.length;o++){const m=h[o],v=E(m);f.includes(v)||(c.splice(o,0,m),y.push(m))}p==="wait"&&y.length&&(c=y),j(I(c)),N(e);return}const{forceRender:R}=n.useContext(b);return x.jsx(x.Fragment,{children:h.map(c=>{const o=E(c),m=e===h||f.includes(o),v=()=>{if(u.has(o))u.set(o,!0);else return;let w=!0;u.forEach(k=>{k||(w=!1)}),w&&(R==null||R(),j(l.current),d&&d())};return x.jsx(B,{isPresent:m,initial:!a.current||s?void 0:!1,custom:m?void 0:t,presenceAffectsLayout:C,mode:p,onExitComplete:m?void 0:v,children:c},o)})})};var M,P;function K(){if(P)return M;P=1;function r(i){return i==null}return M=r,M}var U=K();const O=L(U);export{H as A,O as i};
