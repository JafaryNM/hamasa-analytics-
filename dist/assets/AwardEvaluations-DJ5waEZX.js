import{Y,y as M,a as n,j as e,a9 as z,aQ as F}from"./index-BmTDuvZb.js";import{T as R}from"./FileItem-DzXY3F8e.js";import{a as K}from"./awardService-Bn5RyqjY.js";import{u as U,A as _,R as $}from"./RoundApplications-CjWx2FNb.js";import{T as q}from"./index-BADhTaSU.js";import{j as D,m as H}from"./Drawer-DzqlIjEr.js";import{A as O}from"./AdaptiveCard-CrXiXQ44.js";import{N as P}from"./Notification-tU2EwgzP.js";import{t as I}from"./toast-GyZEIVmG.js";import{h as Q}from"./moment-BLMuvzoS.js";import{B as E}from"./Button-DurQkwM5.js";import"./isNil-pXqcj5Hj.js";import"./index-DiLTFOK_.js";import"./Dialog-DLr3sM2V.js";import{D as V}from"./DebouceInput-CO8iQz0e.js";import"./debounce-BDIv-DRu.js";import"./Badge-CndVQ9ZH.js";import"./FormContainer-DAIJ54eo.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import"./index-Dp3eu27c.js";import{T as y}from"./Tag-CnLXc3pt.js";import{a as G}from"./awardApplicationScoreService-ZyD8A1AC.js";import{R as S,C as x}from"./row-BhmCD8Yc.js";import{F as J,P as W}from"./Table-D5q3gGnO.js";import"./classNames-1IIsPMBF.js";import"./CloseButton-DJjxVEoc.js";import"./apiService-CUP-TZv2.js";import"./useData-BOaL--7C.js";import"./index-D_KHXJS9.js";import"./Card-BgjqMMuG.js";import"./StatusIcon-DsewrCSG.js";import"./context-Du5Tb9SW.js";import"./toConsumableArray-BwQuJZQe.js";import"./useBreakpoint-B4e-Cr1A.js";import"./extendsObject-BwUYxLSG.js";import"./index-D8WFQQX-.js";import"./Compact-BRfsaHnR.js";import"./AntdIcon-Bbd_N7Ky.js";import"./omit-B089rQxj.js";import"./EllipsisOutlined-BvS74-YI.js";import"./getAllowClear-TCr_opQ2.js";import"./useVariants-D5R8gtcG.js";const X=({awardUuid:i,currentRound:k,reloadPage:f})=>{const{signOut:m}=Y(),j=M(),{data:N,total:d,isLoading:T,pagination:r,setPagination:l,authenticated:w}=U({awardUuid:i,status:"pending"}),[p,A]=n.useState(""),[g,o]=n.useState(!1);w||m();const s=()=>r.perPage*(r.page-1),c=()=>{let t=s()+r.perPage;return d<t&&(t=d),t},a=t=>{l({...r,page:t})},u=()=>{l({...r,page:1,search:p})},C=()=>{o(!0);const t={awardUuid:i};G.create(t,"/initialize-round").then(h=>{o(!1),f(),I.push(e.jsx(P,{title:"Successfully ",type:"success",children:"You have successfully closed screening"}))}).catch(h=>{console.log(h),o(!1),I.push(e.jsx(P,{title:"Failed",type:"danger",children:h.response.data.message}))})},B=[{title:"S/n",dataIndex:"s_no",key:"s_no",render:(t,h,L)=>(r.page-1)*r.perPage+L+1},{title:"Title",dataIndex:"title",key:"title"},{title:"Category",dataIndex:"awardCategory",key:"awardCategory",render:t=>t.category.name},{title:"Media Channel",dataIndex:"mediaChannel",key:"mediaChannel",render:t=>(t==null?void 0:t.name)||"-"},{title:"Status",dataIndex:"status",key:"status",render:t=>t=="approved"?e.jsx(y,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 border-0 rounded",children:t}):t=="pending"?e.jsx(y,{className:"text-gray-600 bg-gray-200 dark:text-red-100 dark:bg-gray-500/20 border-0",children:t}):e.jsx(y,{className:"text-red-600 bg-red-100 dark:text-red-100 dark:bg-red-500/20 border-0",children:t})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",render:t=>Q(t).format("DD MMM YYYY")},{title:"Action",dataIndex:"uuid",key:"uuid",render:t=>e.jsx(q,{wrapperClass:"flex",title:"View",children:e.jsx("span",{className:"cursor-pointer p-2 text-primary",onClick:()=>j(`/award-management/awards/evaluations/${i}/application/${t}`),children:e.jsx(H,{size:20})})})}];return e.jsx(z,{children:e.jsx(O,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Applications"}),k==null&&e.jsx(E,{variant:"solid",type:"button",className:"bg-success text-white hover:!bg-success",loading:g,onClick:C,children:"Complete Screening"})]}),e.jsx(S,{className:"mt-5",children:e.jsx(x,{span:24,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsx(V,{placeholder:"Search",suffix:e.jsx(D,{className:"text-lg"}),onChange:t=>A(t.target.value),onKeyDown:t=>t.key==="Enter"&&u()}),e.jsx(E,{icon:e.jsx(D,{}),onClick:()=>u(),children:"Search"})]})})}),e.jsx(S,{className:"mt-5",children:e.jsx(x,{span:24,children:e.jsx(J,{dataSource:N,columns:B,rowKey:"uuid",loading:T,pagination:!1})})}),e.jsxs(S,{className:"mt-4",children:[e.jsx(x,{sm:24,md:12,children:e.jsxs("p",{className:"category",children:["Showing ",s()+1," to ",c()," of ",d," ","entries"]})}),e.jsx(x,{sm:24,md:12,children:e.jsx(W,{align:"end",current:r.page,total:d,pageSize:r.perPage,onChange:a})})]})]})})})},{TabNav:b,TabList:Z,TabContent:v}=R,$e=()=>{const{uuid:i}=F();console.log(i);const[k,f]=n.useState(),[m,j]=n.useState([]),[N,d]=n.useState([]),[T,r]=n.useState(!1),[l,w]=n.useState(null),[p,A]=n.useState("screening");n.useEffect(()=>{g()},[]);const g=()=>{r(!0);const{request:s}=K.show(i??"");s.then(c=>{if(c.data.data!=null){const a=c.data.data;if(f({uuid:a.uuid,title:a.title,description:a.description,startDate:a.startDate,endDate:a.endDate,judgeAccessStartDate:a.judgeAccessStartDate,judgeAccessEndDate:a.judgeAccessEndDate,instructions:a.instructions,isPublished:a.isPublished,isActive:a.isActive,createdAt:a.createdAt}),a.rounds!=null){const u=a.rounds.filter(C=>C.isCurrent)[0];o(u!=null?u.uuid:"screening"),w(u)}j(a.rounds),d(a.awardCategories),r(!1)}}).catch(c=>{console.log(c),r(!1)})};n.useEffect(()=>{o(p??"")},[l]);const o=s=>{console.log(s),A(s)};return e.jsx("div",{children:e.jsxs(R,{defaultValue:p,variant:"pill",onChange:o,children:[e.jsxs(Z,{children:[e.jsx(b,{value:"all",children:"All"}),e.jsx(b,{value:"screening",children:"Screening"}),m.map(s=>e.jsx(b,{value:s.uuid,children:s.name},s.uuid))]}),e.jsxs("div",{className:"p-4",children:[e.jsx(v,{value:"all",children:e.jsx(_,{awardUuid:i})}),e.jsx(v,{value:"screening",children:e.jsx(X,{awardUuid:i,reloadPage:g,currentRound:l})}),m.map(s=>e.jsx(v,{value:s.uuid,children:e.jsx($,{awardUuid:i,awardRoundUuid:s.uuid,currentRound:l})},s.uuid))]})]})})};export{$e as default};
