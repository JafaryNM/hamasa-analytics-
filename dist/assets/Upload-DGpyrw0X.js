import{a as o,j as a}from"./index-BmTDuvZb.js";import{c as C}from"./classNames-1IIsPMBF.js";import{F as G,c as H}from"./FileItem-DzXY3F8e.js";import{B as K}from"./Button-DurQkwM5.js";import{C as Q}from"./CloseButton-DJjxVEoc.js";import{N as V}from"./Notification-tU2EwgzP.js";import{t as W}from"./toast-GyZEIVmG.js";const k=n=>Object.keys(n).map(p=>n[p]),re=n=>{const{accept:p,beforeUpload:N,disabled:l=!1,draggable:t=!1,fileList:c=[],fileListClass:D,fileItemClass:O,multiple:L,onChange:u,onFileRemove:m,ref:U,showList:S=!0,tip:E,uploadLimit:f,children:g,className:I,...j}=n,v=o.useRef(null),[i,h]=o.useState(c),[B,b]=o.useState(!1);o.useEffect(()=>{JSON.stringify(i)!==JSON.stringify(c)&&h(c)},[JSON.stringify(c)]);const x=(s="")=>{W.push(a.jsx(V,{type:"danger",duration:2e3,children:s||"Upload Failed!"}),{placement:"top-center"})},y=(s,e)=>{if(s)for(const r of s)e.push(r);return e},J=s=>{let e=H(i);return typeof f=="number"&&f!==0&&Object.keys(e).length>=f?(f===1&&(e.shift(),e=y(s,e)),k({...e})):(e=y(s,e),k({...e}))},w=s=>{const{files:e}=s.target;let r=!0;if(N){if(r=N(e,i),r===!1){x();return}if(typeof r=="string"&&r.length>0){x(r);return}}if(r){const d=J(e);h(d),u==null||u(d,i)}},P=s=>{const e=i.filter((r,d)=>d!==s);h(e),m==null||m(e)},A=s=>{var e;l||(e=v.current)==null||e.click(),s.stopPropagation()},M=()=>!t&&!g?a.jsx(K,{disabled:l,onClick:s=>s.preventDefault(),children:"Upload"}):t&&!g?a.jsx("span",{children:"Choose a file or drag and drop here"}):g,R=o.useCallback(()=>{t&&b(!1)},[t]),T=o.useCallback(()=>{t&&!l&&b(!0)},[t,l]),_=o.useCallback(()=>{t&&b(!1)},[t]),$={onDragLeave:R,onDragOver:T,onDrop:_},F="border-primary",q=C("upload",t&&"upload-draggable",t&&!l&&`hover:${F}`,t&&l&&"disabled",B&&F,I),z=C("upload-input",t&&"draggable");return a.jsxs(a.Fragment,{children:[a.jsxs("div",{ref:U,className:q,...t?$:{onClick:A},...j,children:[a.jsx("input",{ref:v,className:z,type:"file",disabled:l,multiple:L,accept:p,title:"",value:"",onChange:w,...j}),M()]}),E,S&&a.jsx("div",{className:C("upload-file-list",D),children:i.map((s,e)=>a.jsx(G,{file:s,className:O,children:a.jsx(Q,{className:"upload-file-remove",onClick:()=>P(e)})},s.name+e))})]})};export{re as U};
