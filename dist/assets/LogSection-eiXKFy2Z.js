import{y as H,a as p,j as s,a6 as $,aR as q,i as z}from"./index-BmTDuvZb.js";import{C as O}from"./Card-BgjqMMuG.js";import{B as b}from"./Button-DurQkwM5.js";import{H as J}from"./index-BADhTaSU.js";import{N}from"./Notification-tU2EwgzP.js";import{t as w}from"./toast-GyZEIVmG.js";import{C as k}from"./ConfirmDialog-teBenfrx.js";import{F as K,G as Q}from"./CloseButton-DJjxVEoc.js";import{h as C}from"./moment-BLMuvzoS.js";import{A as X}from"./AdminSchema-BVavU2lW.js";import{u as Z,t as ee,F as se,a as j,C as v}from"./types-CS3IvESl.js";import{u as I}from"./userService-fbSkJ2gC.js";import{I as y}from"./FormContainer-DAIJ54eo.js";import"./Badge-CndVQ9ZH.js";import{P as re}from"./FileItem-DzXY3F8e.js";import{D as oe}from"./Dialog-DLr3sM2V.js";import"./Drawer-DzqlIjEr.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import{S as le}from"./Select-BSoHUsjb.js";import"./index-Dp3eu27c.js";import{T as F}from"./Tag-CnLXc3pt.js";import{a as te}from"./index-DOf9FwXt.js";import{u as ne}from"./useData-BOaL--7C.js";import"./isNil-pXqcj5Hj.js";const ie="/assets/user-Bxve6QKh.png",ae=[{label:"Male",value:"Male"},{label:"Female",value:"Female"}],h=({title:e,value:d})=>s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold block",children:e}),e!="Status"&&s.jsx("p",{className:"heading-text font-bold",children:d}),e=="Status"?d==!0?s.jsx(F,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 border-0 rounded mt-1",children:"Active"}):s.jsx(F,{className:"text-red-600 bg-red-100 dark:text-red-100 dark:bg-red-500/20 border-0 mt-1",children:"Inactive"}):""]}),Ue=({data:e,reloadFunc:d})=>{var M,E,S,P,R,L,T;const f=H(),[o,a]=p.useState({record:null,isCreate:!0,loading:!1,showModal:!1}),[i,m]=p.useState({record:null,loading:!1,showModal:!1}),[g,u]=p.useState({loading:!1,showModal:!1}),{control:t,reset:c,handleSubmit:n,formState:{errors:l}}=Z({resolver:ee(X)}),[ue,he]=p.useState(!1),B=()=>{a({...o,isCreate:!1,showModal:!1})},U=()=>{c({firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName,gender:{label:e==null?void 0:e.gender,value:e==null?void 0:e.gender},phone:e==null?void 0:e.phone,email:e==null?void 0:e.email}),a({...o,record:e,isCreate:!1,showModal:!0})},G=r=>{a({...o,loading:!0});const A={...r,gender:r.gender.value,uuid:o.record!=null?o.record.uuid:""};I.update(A).then(x=>{w.push(s.jsx(N,{title:"Successfully Updated",type:"success",children:"Admin details has been successfully updated"})),c(),a({record:null,loading:!1,isCreate:!0,showModal:!1}),d()}).catch(x=>{w.push(s.jsx(N,{title:"Error",type:"danger",children:x.response!=null&&x.response.data!=null&&x.response.data.message!=null?x.response.data.message:"Something went wrong, try again please!!"})),a({...o,loading:!1})})},Y=()=>{u({loading:!1,showModal:!0})},V=()=>{m({...i,loading:!0}),$.resetPassword((e==null?void 0:e.uuid)??"").then(r=>{u({loading:!1,showModal:!1}),w.push(s.jsx(N,{title:"Successfully Reset",type:"success",children:"Password has been successfully resetted"}))}).catch(r=>{u({...g,loading:!1})})},_=()=>{m({...i,record:e,showModal:!0})},D=()=>{m({...i,record:null,showModal:!1})},W=()=>{var r;m({...i,loading:!0}),I.delete(((r=i.record)==null?void 0:r.uuid)??"").then(A=>{m({record:null,loading:!1,showModal:!1}),f("/user-management/admins"),w.push(s.jsx(N,{title:"Successfully Deleted",type:"success",children:"Admin has been successfully deleted"}))}).catch(A=>{m({...i,loading:!1})})};return s.jsxs(O,{className:"w-full",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(b,{variant:"plain",className:"flex items-center justify-center text-warning border-none hover:text-warning gap-2",onClick:U,children:[s.jsx(K,{})," Edit"]})}),s.jsxs("div",{className:"flex flex-col xl:justify-between h-full 2xl:min-w-[360px] mx-auto",children:[s.jsxs("div",{className:"flex xl:flex-col items-center gap-4 mt-6",children:[s.jsx(J,{size:90,shape:"circle",src:(e==null?void 0:e.profilePicUrl)||ie,alt:`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`}),s.jsxs("h4",{className:"font-bold",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-10",children:[s.jsx(h,{title:"First Name",value:e==null?void 0:e.firstName}),s.jsx(h,{title:"Last Name",value:e==null?void 0:e.lastName}),s.jsx(h,{title:"Email",value:e==null?void 0:e.email}),s.jsx(h,{title:"Phone",value:e==null?void 0:e.phone}),s.jsx(h,{title:"Last Online",value:C(e==null?void 0:e.createdAt).format("DD MMM, YYYY hh:mm A")}),s.jsx(h,{title:"Status",value:e==null?void 0:e.isActive})]}),s.jsxs("div",{className:"flex flex-col gap-4 mt-7",children:[s.jsx(b,{block:!0,customColorClass:()=>"text-default hover:border-default hover:ring-1 ring-default hover:text-default",icon:s.jsx(te,{}),onClick:()=>Y(),children:"Reset Password"}),s.jsx(b,{block:!0,customColorClass:()=>"text-error hover:border-error hover:ring-1 ring-error hover:text-error",icon:s.jsx(Q,{}),onClick:()=>_(),children:"Delete"})]}),s.jsxs(oe,{isOpen:o.showModal,onClose:B,children:[s.jsx("h4",{className:"mb-4 text-center",children:o.isCreate?"Create Admin":"Update Admin"}),s.jsxs(se,{onSubmit:n(G),children:[s.jsx(j,{label:"First Name",invalid:!!l.firstName,errorMessage:(M=l.firstName)==null?void 0:M.message,children:s.jsx(v,{name:"firstName",control:t,render:({field:r})=>s.jsx(y,{type:"text",placeholder:"First Name",autoComplete:"off",...r})})}),s.jsx(j,{label:"Last Name",invalid:!!l.lastName,errorMessage:(E=l.lastName)==null?void 0:E.message,children:s.jsx(v,{name:"lastName",control:t,render:({field:r})=>s.jsx(y,{type:"text",placeholder:"Last Name",autoComplete:"off",...r})})}),s.jsx(j,{label:"Gender",invalid:!!l.gender,errorMessage:(S=l.gender)==null?void 0:S.message,children:s.jsx(v,{name:"gender",control:t,render:({field:r})=>s.jsx(le,{placeholder:"Select Gender",options:ae,...r})})}),s.jsx(j,{label:"Phone Number",invalid:!!l.phone,errorMessage:(P=l.phone)==null?void 0:P.message,children:s.jsx(v,{name:"phone",control:t,render:({field:r})=>s.jsx(y,{type:"text",placeholder:"Phone Number",autoComplete:"off",...r})})}),s.jsx(j,{label:"Email Address",invalid:!!l.email,errorMessage:(R=l.email)==null?void 0:R.message,children:s.jsx(v,{name:"email",control:t,render:({field:r})=>s.jsx(y,{type:"text",placeholder:"Email Address",autoComplete:"off",...r})})}),s.jsx(b,{loading:o.loading,variant:"solid",type:"submit",children:o.isCreate?"Create":"Update"})]})]}),s.jsx(k,{isOpen:g.showModal,type:"warning",title:"Warning",confirmText:"Reset",cancelButtonProps:{variant:"solid",color:"default",customColorClass:()=>"text-dark bg-gray-200 hover:bg-default mr-3"},confirmButtonProps:{variant:"solid",color:"warning",customColorClass:()=>"text-white bg-warning hover:bg-warning",loading:g.loading},onClose:()=>u({loading:!1,showModal:!1}),onCancel:()=>u({loading:!1,showModal:!1}),onConfirm:V,children:s.jsxs("p",{children:[" ","This action is irreversible! Reseting"," ",s.jsxs("span",{className:"font-semibold",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName,"'s"," "]}),"password will reset password to default"," ",s.jsx("span",{className:"font-semibold",children:" 12345678"}),". Are you sure you want to proceed?"]})}),s.jsx(k,{isOpen:i.showModal,type:"danger",title:"Warning",confirmText:"Delete",cancelButtonProps:{variant:"solid",color:"default",customColorClass:()=>"text-dark bg-gray-200 hover:bg-default mr-3"},confirmButtonProps:{variant:"solid",color:"danger",customColorClass:()=>"text-white bg-error hover:bg-error",loading:i.loading},onClose:D,onCancel:D,onConfirm:W,children:s.jsxs("p",{children:[" ","This action is irreversible! Deleting"," ",s.jsxs("span",{className:"font-semibold",children:[(L=i.record)==null?void 0:L.firstName," ",(T=i.record)==null?void 0:T.lastName," "]}),"will permanently be removed from the system. Are you sure you want to proceed?"]})})]})]})},ce=e=>ne(`/user-logs/user/${e}`,{search:"",page:1,perPage:7}),de=e=>{switch(e){case"CREATED":return{title:"Created Record",description:"A new record has been successfully created."};case"UPDATED":return{title:"Updated Record",description:"An existing record has been updated."};case"VIEWED_LIST":return{title:"Viewed List",description:"A list of records has been viewed."};case"VIEWED_ITEM":return{title:"Viewed Item",description:"A specific item was viewed in detail."};case"DELETED":return{title:"Deleted Record",description:"A record has been permanently deleted."};case"VIEWED_REPORT":return{title:"Viewed Report",description:"A report was accessed and viewed."};case"LOGGED_IN":return{title:"User Logged In",description:"A user has successfully logged into the system."};case"LOGGED_OUT":return{title:"User Logged Out",description:"A user has logged out of the system."};case"PENDINF":return{title:"Pending Approval",description:"A request is awaiting approval."};case"APPROVED_STAGE":return{title:"Stage Approved",description:"A stage in the process has been approved."};case"REJECTED_STAGE":return{title:"Stage Rejected",description:"A stage in the process has been rejected."};default:return{title:"Unknown Log Type",description:"No details available for this log type."}}},me=e=>{const{type:d,module:f}=e,{title:o,description:a}=de(d);return s.jsxs("div",{children:[s.jsxs("h6",{className:"font-bold",children:[o," - ",f]}),s.jsx("p",{className:"font-semibold",children:a})]})},Ge=({uuid:e})=>{const[d,f]=p.useState({}),{data:o,isLoading:a,pagination:i,setPagination:m}=ce(e??"");p.useEffect(()=>{const t=g(o);f(t),console.log(t)},[o]);const g=t=>t.reduce((c,n)=>{const l=C(n==null?void 0:n.createdAt).format("DD MMM, YYYY");return c[l]||(c[l]=[]),c[l].push(n),c},{}),u=t=>{m({...i,page:t})};return s.jsxs("div",{className:"",children:[s.jsx(q,{loading:a,children:Object.entries(d).map(([t,c])=>s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"mb-4 font-bold uppercase flex items-center gap-4",children:[s.jsx("span",{className:"w-[70px] heading-text",children:C(t).format("DD MMM")}),s.jsx("div",{className:"border-b border-2 border-gray-200 dark:border-gray-600 border-dashed w-full"})]}),s.jsx("div",{className:"flex flex-col gap-4",children:z(c)?s.jsx("div",{children:"No Activities"}):c.map((n,l)=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold w-[100px]",children:C(n==null?void 0:n.createdAt).format("h:mm A")}),s.jsx(O,{className:"max-w-[600px] w-full",bodyClass:"py-3",children:s.jsx("div",{className:"flex items-center gap-4",children:s.jsx(me,{type:n.event,module:n.module})})})]},n.event+l))})]},t))}),!a&&o.length===0?s.jsx("div",{className:"flex justify-center items-center",style:{height:"60vh"},children:s.jsx("p",{children:"No data is available"})}):"",s.jsx(re,{className:"flex justify-end mt-10",onChange:u})]})};export{Ge as L,Ue as P};
