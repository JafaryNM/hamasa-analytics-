import{aQ as M,a as i,y as F,j as e,aR as P}from"./index-BmTDuvZb.js";import{a as _}from"./applicationService-RqaSRVra.js";import{C as g}from"./Card-BgjqMMuG.js";import{D as y}from"./Dialog-DLr3sM2V.js";import{t as T,u as R,s as E}from"./Drawer-DzqlIjEr.js";import"./index-BADhTaSU.js";import"./Badge-CndVQ9ZH.js";import{B as h}from"./Button-DurQkwM5.js";import"./FileItem-DzXY3F8e.js";import{o as L,s as I,u as O,t as Y,F as B,a as G,C as $}from"./types-CS3IvESl.js";import{I as q}from"./FormContainer-DAIJ54eo.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import"./index-Dp3eu27c.js";import{T as p}from"./Tag-CnLXc3pt.js";import"./toast-GyZEIVmG.js";import{A as U,D as Q,P as V,_ as W,a as z}from"./index-k8z-5w5v.js";import{h as H}from"./moment-BLMuvzoS.js";import{a as J}from"./awardApplicationScoreService-ZyD8A1AC.js";import"./apiService-CUP-TZv2.js";import"./CloseButton-DJjxVEoc.js";import"./isNil-pXqcj5Hj.js";import"./classNames-1IIsPMBF.js";import"./index-D_KHXJS9.js";import"./context-Du5Tb9SW.js";import"./toConsumableArray-BwQuJZQe.js";import"./useBreakpoint-B4e-Cr1A.js";import"./index-D8WFQQX-.js";import"./Compact-BRfsaHnR.js";const K=L({comments:I().min(1,"Comments are required")});z.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${W}/pdf.worker.js`;const j=a=>{var n;const l=(n=a.split(".").pop())==null?void 0:n.toLowerCase();return l?["jpg","jpeg","png","gif","bmp","webp"].includes(l)?"image":["mp4","avi","mov","mkv","wmv"].includes(l)?"video":["pdf"].includes(l)?"pdf":"file":"file"},X=({attachment:a})=>{const[l,n]=i.useState(null),[d,s]=i.useState(1),[m,t]=i.useState(!1),o=({numPages:x})=>{n(x)};return j(a.url)==="image"?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a.url,alt:"Attachment",className:"w-full h-auto  object-cover rounded-md cursor-pointer",onClick:()=>t(!0)}),m&&e.jsx(y,{isOpen:m,onClose:()=>t(!1),children:e.jsx("div",{className:"flex flex-col items-center p-4",children:e.jsx("img",{src:a.url,alt:"Preview",className:"w-full max-w-md rounded-lg"})})})]}):j(a.url)==="video"?e.jsxs("video",{controls:!0,className:"w-full h-40 rounded-md",children:[e.jsx("source",{src:a.url,type:"video/mp4"}),"Your browser does not support the video tag."]}):j(a.url)==="pdf"?e.jsxs("div",{className:"border rounded-lg p-3 shadow-md bg-gray-50 dark:bg-gray-800",children:[e.jsx(Q,{file:a.url,onLoadSuccess:o,children:e.jsx(V,{pageNumber:d,width:250})}),e.jsxs("div",{className:"text-center mt-2",children:[e.jsxs("p",{children:["Page ",d," of ",l]}),e.jsx("button",{disabled:d<=1,onClick:()=>s(d-1),className:"text-blue-500 px-2",children:"Prev"}),e.jsx("button",{disabled:d>=(l??1),onClick:()=>s(d+1),className:"text-blue-500 px-2",children:"Next"})]})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(E,{className:"text-4xl text-blue-500 mb-2"}),e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:a.title||"Download File"})]})},De=()=>{var w;const{uuid:a,applicationUuid:l}=M(),[n,d]=i.useState(!1),[s,m]=i.useState(),[t,o]=i.useState({record:null,isCreate:!0,loading:!1,showModal:!1}),{control:x,reset:f,handleSubmit:C,formState:{errors:v}}=O({resolver:Y(K)}),k=F();i.useEffect(()=>{A()},[]);const A=()=>{d(!0);const{request:r}=_.show(l??"");r.then(c=>{if(c.data.data!=null){const u=c.data.data;m(u)}d(!1)}).catch(c=>{console.log(c),d(!1)})},b=()=>{f({comments:""})},N=r=>{b(),o({...t,record:r,isCreate:!0,showModal:!0})},S=()=>{b(),o({...t,record:null,isCreate:!0,showModal:!1})},D=r=>{o({...t,loading:!0});const c={awardUuid:a,applicationUuid:l,comments:r.comments};J.create(c,`${t.record=="approved"?"/approve":"/reject"}`).then(u=>{f(),o({record:null,loading:!1,isCreate:!0,showModal:!1}),k(`/judge-management/awards/evaluations/${a}`)}).catch(u=>{o({...t,loading:!1})})};return e.jsxs(P,{loading:n,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"gap-4 flex flex-col flex-auto",children:[e.jsxs(g,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"mb-4 font-semibold text-lg",children:"Application Details"}),e.jsx("div",{children:(s==null?void 0:s.status)=="approved"?e.jsx(p,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 border-0 rounded",children:s==null?void 0:s.status}):(s==null?void 0:s.status)=="pending"?e.jsx(p,{className:"text-gray-600 bg-gray-200 dark:text-red-100 dark:bg-gray-500/20 border-0",children:s==null?void 0:s.status}):e.jsx(p,{className:"text-red-600 bg-red-100 dark:text-red-100 dark:bg-red-500/20 border-0",children:s==null?void 0:s.status})})]}),e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4",children:[e.jsx("div",{className:"font-bold",children:"Title"}),e.jsx("div",{className:"mt-1",children:s==null?void 0:s.title})]}),e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4 mt-8",children:[e.jsx("div",{className:"font-bold",children:"Description"}),e.jsx("div",{className:"mt-1",children:s==null?void 0:s.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4 mt-8",children:[e.jsx("div",{className:"font-bold",children:"Published Date"}),e.jsx("div",{className:"mt-1",children:H(s==null?void 0:s.publishedDate).format("DD MMM YYYY")})]}),e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4 mt-8",children:[e.jsx("div",{className:"font-bold",children:"Category"}),e.jsx("div",{className:"mt-1",children:s==null?void 0:s.awardCategory.category.name})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4 mt-8",children:[e.jsx("div",{className:"font-bold",children:"Media Channel"}),e.jsx("div",{className:"mt-1",children:s!=null&&s.mediaChannel?s.mediaChannel.name:"N/A"})]}),e.jsxs("div",{className:"rounded-xl bg-gray-100 dark:bg-gray-700 p-4 mt-8",children:[e.jsx("div",{className:"font-bold",children:"Type"}),e.jsx("div",{className:"mt-1",children:s!=null&&s.isGroup?"Group Application":"Single Application"})]})]})]}),e.jsxs(g,{children:[e.jsx("h4",{className:"mb-4 font-semibold text-lg",children:"Attachment Details"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 p-4",children:s!=null&&s.attachments&&s.attachments.length>0?s.attachments.map(r=>e.jsx("div",{className:"border rounded-lg p-3 shadow-md w-[160px]",children:e.jsx(X,{attachment:r})},r.uuid)):e.jsx("p",{className:"text-gray-500 text-center col-span-2 md:col-span-3",children:"No attachments found"})})]}),(s==null?void 0:s.status)=="pending"&&e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(h,{variant:"solid",type:"button",className:"bg-red-600 text-white hover:!bg-red-600",onClick:()=>N("rejected"),children:"Reject"}),e.jsx(h,{variant:"solid",type:"button",className:"bg-success text-white hover:!bg-success",onClick:()=>N("approved"),children:"Approve"})]})})]}),e.jsx("div",{className:"lg:w-[320px] xl:w-[420px] gap-4 flex flex-col",children:e.jsxs(g,{children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{}),e.jsx("div",{children:s==null?void 0:s.members.map(r=>e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold heading-text",children:[r.member.firstName," ",r.member.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:r.member.phone})]},r.uuid))})]})}),e.jsx("hr",{className:"my-5"}),s==null?void 0:s.members.map(r=>e.jsxs("div",{className:"flex flex-col gap-2 text-gray-600",children:[r.member.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-xl opacity-70"}),e.jsx("span",{children:r.member.email})]}),r.member.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"text-xl opacity-70"}),e.jsx("span",{children:r.member.phone})]})]},r.uuid))]})})]}),e.jsxs(y,{isOpen:t.showModal,onClose:S,children:[e.jsx("h4",{className:"mb-4 text-center",children:t.record=="approved"?"Approve Application":"Reject Evaluation"}),e.jsxs(B,{onSubmit:C(D),children:[e.jsx(G,{label:"Comments",invalid:!!v.comments,errorMessage:(w=v.comments)==null?void 0:w.message,children:e.jsx($,{name:"comments",control:x,render:({field:r})=>e.jsx(q,{type:"text",placeholder:"Comments",autoComplete:"off",textArea:!0,...r})})}),e.jsx(h,{loading:t.loading,variant:"solid",type:"submit",className:t.record=="approved"?"bg-success text-white hover:!bg-success":"bg-red-600 text-white hover:!bg-red-600",children:t.record=="approved"?"Approve":"Reject"})]})]})]})};export{De as default};
