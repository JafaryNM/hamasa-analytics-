import{a as I,y as Y,Y as k,j as e,a6 as L,u as U}from"./index-BmTDuvZb.js";import{L as R}from"./Logo-IF-9I2F4.js";import{o as B,b as V,s as i,c as D,d as G,Z as T,u as Z,F as J,a as l,C as m,t as W}from"./types-CS3IvESl.js";import{I as p}from"./FormContainer-DAIJ54eo.js";import{B as _}from"./Button-DurQkwM5.js";import{D as $,C as q}from"./FileItem-DzXY3F8e.js";import"./index-BADhTaSU.js";import"./Badge-CndVQ9ZH.js";import"./Dialog-DLr3sM2V.js";import"./Drawer-DzqlIjEr.js";import"./index-Kv-3TB7K.js";import"./index-B2aNPlXf.js";import{N as f}from"./Notification-tU2EwgzP.js";import{S as z}from"./Select-BSoHUsjb.js";import"./index-Dp3eu27c.js";import{t as j}from"./toast-GyZEIVmG.js";import{A as H}from"./ActionLink-BTka9GBU.js";import{C as K}from"./Card-BgjqMMuG.js";import"./isNil-pXqcj5Hj.js";import"./classNames-1IIsPMBF.js";import"./CloseButton-DJjxVEoc.js";import"./index-D_KHXJS9.js";import"./StatusIcon-DsewrCSG.js";import"./toConsumableArray-BwQuJZQe.js";const Q=B({firstName:i().refine(s=>s.trim()!=="",{message:"Please enter your first name"}),lastName:i().refine(s=>s.trim()!=="",{message:"Please enter your last name"}),gender:D([i(),B({value:i()})]).transform(s=>typeof s=="string"?s:s.value).refine(s=>["Male","Female"].includes(s),{message:"Please select either Male or Female"}),phone:i().refine(s=>s.length===10,{message:"Phone number must be 10 digits long"}),email:i().superRefine((s,d)=>{!s||s.trim()===""?d.addIssue({code:T.custom,message:"Enter your email address"}):/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/g.test(s)||d.addIssue({code:T.custom,message:"Please enter a valid email address"})}),birthDate:D([i(),G()]).transform(s=>s instanceof Date?s.toISOString().split("T")[0]:s).refine(s=>!isNaN(Date.parse(s)),{message:"Please select a valid date"}),password:i().refine(s=>s.trim().length>=8,{message:"Password must be at least 8 characters"}),passwordConfirmation:i().refine(s=>s.trim()!=="",{message:"Confirm your password"}),termsAccepted:V().refine(s=>s===!0,{message:"Please accept the terms and conditions to continue"})}).refine(s=>s.password===s.passwordConfirmation,{message:"Passwords do not match",path:["passwordConfirmation"]}),X=({disableSubmit:s=!1})=>{var b,v,y,N,w,S,C,M,P;const[d,g]=I.useState(!1),o=Y(),{user:h}=k();console.log(h);const{handleSubmit:x,formState:{errors:t},control:n}=Z({resolver:W(Q),defaultValues:{termsAccepted:!1}}),E=a=>{console.log(a),g(!0),L.register(a).then(r=>{var u,A,F;const c=(u=r.data)==null?void 0:u.user;(A=r.data)!=null&&A.success?c!=null&&c.verifiedAt?(j.push(e.jsx(f,{title:"Success",type:"success",children:"Registration complete. You may now sign in."})),setTimeout(()=>{o("/login")},3e3)):(j.push(e.jsx(f,{title:"Verify Phone",type:"success",children:"You will receive a token on your phone number."})),setTimeout(()=>{o("/otp-verification",{state:{phone:c.phone,autoResend:!0}})},3e3)):j.push(e.jsx(f,{title:"Signup Failed",type:"danger",children:((F=r.data)==null?void 0:F.message)||"Signup failed. Please try again."}))}).catch(r=>{var c,u;j.push(e.jsx(f,{title:"Error",type:"danger",children:((u=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:u.message)||"An error occurred. Try again."}))}).finally(()=>{g(!1)})};return e.jsxs(J,{onSubmit:x(E),className:"mt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"First Name",invalid:!!t.firstName,errorMessage:(b=t.firstName)==null?void 0:b.message,children:e.jsx(m,{name:"firstName",control:n,render:({field:a})=>e.jsx(p,{type:"text",...a})})}),e.jsx(l,{label:"Last Name",invalid:!!t.lastName,errorMessage:(v=t.lastName)==null?void 0:v.message,children:e.jsx(m,{name:"lastName",control:n,render:({field:a})=>e.jsx(p,{type:"text",...a})})}),e.jsx(l,{label:"Gender",invalid:!!t.gender,errorMessage:(y=t.gender)==null?void 0:y.message,children:e.jsx(m,{name:"gender",control:n,render:({field:a})=>e.jsx(z,{...a,options:[{value:"Male",label:"Male"},{value:"Female",label:"Female"}],placeholder:"Select Gender",getOptionLabel:r=>r.label,getOptionValue:r=>r.value,onChange:r=>a.onChange(r==null?void 0:r.value),value:a.value?{value:a.value,label:a.value}:null})})}),e.jsx(l,{label:"Phone Number",invalid:!!t.phone,errorMessage:(N=t.phone)==null?void 0:N.message,children:e.jsx(m,{name:"phone",control:n,render:({field:a})=>e.jsx(p,{type:"tel",...a})})}),e.jsx(l,{label:"Email",invalid:!!t.email,errorMessage:(w=t.email)==null?void 0:w.message,children:e.jsx(m,{name:"email",control:n,render:({field:a})=>e.jsx(p,{type:"email",...a})})}),e.jsx(l,{label:"Date of Birth",invalid:!!t.birthDate,errorMessage:(S=t.birthDate)==null?void 0:S.message,children:e.jsx(m,{name:"birthDate",control:n,render:({field:a})=>e.jsx($,{...a,inputFormat:"MMM, DD YYYY",value:a.value?new Date(a.value):void 0})})}),e.jsx(l,{label:"Password",invalid:!!t.password,errorMessage:(C=t.password)==null?void 0:C.message,children:e.jsx(m,{name:"password",control:n,render:({field:a})=>e.jsx(p,{type:"password",...a})})}),e.jsx(l,{label:"Confirm Password",invalid:!!t.passwordConfirmation,errorMessage:(M=t.passwordConfirmation)==null?void 0:M.message,children:e.jsx(m,{name:"passwordConfirmation",control:n,render:({field:a})=>e.jsx(p,{type:"password",...a})})})]}),e.jsx(l,{invalid:!!t.termsAccepted,errorMessage:(P=t.termsAccepted)==null?void 0:P.message,children:e.jsx(m,{name:"termsAccepted",control:n,render:({field:a})=>e.jsxs("div",{className:"flex items-start gap-2 mt-4",children:[e.jsx(q,{...a,checked:a.value}),e.jsxs("label",{htmlFor:"termsAccepted",className:"text-sm text-gray-700",children:["I agree to the"," ",e.jsx("a",{href:"/terms",target:"_blank",className:"text-blue-500 underline",children:"Terms and Conditions"}),"."]})]})})}),e.jsx("div",{className:"flex justify-left mt-6",children:e.jsx(_,{type:"submit",variant:"solid",disabled:s||d,children:d?"Submitting...":"Create Account"})})]})},O=({signInUrl:s="/sign-in",disableSubmit:d})=>{const g=U(t=>t.mode),{user:o,authenticated:h}=k(),x=Y();return I.useEffect(()=>{h&&(o==null?void 0:o.type)==="journalist"&&(o==null?void 0:o.verifiedAt)===null&&x("/otp-verification",{state:{phone:o.phone,autoResend:!0}})},[h,o,x]),e.jsxs(K,{className:"w-full  mx-auto text-center",children:[e.jsx("div",{className:"mb-8 flex justify-center",children:e.jsx(R,{type:"streamline",mode:g,imgClass:"w-[60px]",logoWidth:60})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-1 text-xl font-semibold",children:"Sign Up"}),e.jsx("p",{className:"font-medium heading-text",children:"Step Into the Future of Journalism with UTPC"})]}),e.jsx(X,{disableSubmit:d}),e.jsxs("div",{className:"mt-6",children:[e.jsx("span",{children:"Already have an account? "}),e.jsx(H,{to:s,className:"heading-text font-bold",themeColor:!1,children:"Sign in"})]})]})},Se=()=>e.jsx(O,{});export{O as SignUpBase,Se as default};
